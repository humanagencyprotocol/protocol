---
import BaseLayout from '../layouts/BaseLayout.astro';
---

<BaseLayout title="HAP - Preserving Human Agency in the Age of AI">
    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-content">
        <h1>AI executes. <br><span class="highlight">Humans decide.</span></h1>
        <h2 class="hero-subtitle">HAP enforces human-authored direction.<br>Execution is impossible without a Decision Owner.</h2>

        <div class="hero-body">
            <p>AI executes the <strong>how</strong>.<br>Humans decide the <strong>why</strong>.</p>
            <p class="key-statement"><strong><span class="highlight">The more AI runs your business, the more you need HAP to prevent the disaster no one took responsibility for.</span></strong></p>
        </div>

        <div class="cta-group">
            <button id="ask-ai-btn" class="btn btn-primary">Explore Use Cases</button>
            <a href="#why-exists" class="btn btn-secondary">Read more</a>
        </div>

        <!-- Card Selector -->
        <div id="card-section" class="card-section" style="display: none;">
            <h2 class="card-section-title">Select a use case to generate a ready-to-paste prompt for your AI chat.</h2>

            <div class="cards-grid">
                <button class="use-case-card" data-card="development">
                    <h3 class="card-title">Development / Deployments</h3>
                    <p class="card-description">No deployment until the right owners commit to what ships and why.</p>
                    <span class="card-badge">Live demo</span>
                </button>

                <button class="use-case-card" data-card="agents">
                    <h3 class="card-title">AI Agents</h3>
                    <p class="card-description">Agents execute within human-approved bounds; expansions require attestation.</p>
                </button>

                <button class="use-case-card" data-card="infrastructure">
                    <h3 class="card-title">Infrastructure</h3>
                    <p class="card-description">No production infrastructure change without domain owners signing off.</p>
                </button>

                <button class="use-case-card" data-card="database">
                    <h3 class="card-title">Database &amp; Data</h3>
                    <p class="card-description">No schema change, destructive query, or export without a named human committing.</p>
                </button>

                <button class="use-case-card" data-card="financial">
                    <h3 class="card-title">Financial Operations</h3>
                    <p class="card-description">No money movement without explicit human commitment.</p>
                </button>

                <button class="use-case-card" data-card="access">
                    <h3 class="card-title">Access &amp; Identity</h3>
                    <p class="card-description">No permission grant or role escalation without a named owner signing off.</p>
                </button>

                <button class="use-case-card" data-card="security">
                    <h3 class="card-title">Security-Sensitive Changes</h3>
                    <p class="card-description">No security-impacting change without security owner attestation.</p>
                </button>

                <button class="use-case-card" data-card="product">
                    <h3 class="card-title">Customer-Facing Product</h3>
                    <p class="card-description">No user-impacting change without product owner commitment.</p>
                </button>

                <button class="use-case-card" data-card="compliance">
                    <h3 class="card-title">Compliance &amp; Regulated</h3>
                    <p class="card-description">Cryptographic proof of required human oversight before execution.</p>
                </button>

                <!-- Or separator -->
                <div class="or-separator">
                    <span class="or-text">Or</span>
                </div>

                <button class="use-case-card" data-card="question">
                    <h3 class="card-title">Ask a question about HAP</h3>
                    <p class="card-description">Type your question and get HAP spec context.</p>
                </button>
            </div>

            <!-- Prompt Panel -->
            <div id="prompt-panel" class="prompt-display" style="display: none;">
                <div class="prompt-content">
                    <!-- Demo link (development card only) -->
                    <div id="demo-link" class="demo-link" style="display: none;">
                        <a href="https://demo.humanagencyprotocol.org/" target="_blank" rel="noopener noreferrer">Try the live demo — see HAP enforcement in a real deploy gate</a>
                    </div>

                    <!-- Prompt preview -->
                    <div id="prompt-preview">
                        <p class="prompt-intro">Copy this prompt into your AI chat to learn how HAP applies to this use case:</p>
                        <div class="prompt-box">
                            <pre id="prompt-text" class="prompt-text"></pre>
                        </div>
                    </div>

                    <!-- Optional additional context -->
                    <label id="context-label" class="wildcard-label">Optional: Add your own context</label>
                    <textarea
                        id="context-input"
                        class="wildcard-input"
                        placeholder="e.g., Describe your specific setup, team, or constraints..."
                    ></textarea>

                    <!-- Question input (question card only) -->
                    <div id="question-section" style="display: none;">
                        <label class="wildcard-label">Your question about HAP:</label>
                        <textarea
                            id="question-input"
                            class="wildcard-input"
                            placeholder="e.g., How does attestation work? What are the six gates? How does HAP handle multi-stakeholder decisions?"
                        ></textarea>
                    </div>

                    <div class="prompt-actions">
                        <button id="copy-btn" class="btn btn-primary">Copy Prompt</button>
                    </div>
                </div>
            </div>
        </div>
        </div>
    </section>

    <!-- The Scarcity of Direction -->
    <section id="why-exists" class="content-section">
        <h2 class="section-title">The Scarcity of Direction</h2>
        <div class="section-body">
            <p>Modern AI doesn't wait. It predicts, escalates, and acts at machine speed. But without human leadership, AI moves into a <strong>decision vacuum—substituting statistical probability for the unique human innovation that creates real value.</strong></p>
            
            <p>To remain in control, we must enforce a fundamental boundary:</p>

            <blockquote class="axiom-block">
                “No consequential action may be taken in a human system without an identifiable human who has explicitly authorized it, understood its tradeoffs, and accepted responsibility for its outcomes.”
            </blockquote>

            <p>HAP turns this axiom into infrastructure. It ensures every action traces back to a human <strong>Decision Owner</strong> who provides the direction machine intelligence cannot duplicate. By forcing AI to pause at the point of irreversibility, HAP keeps authorship human and innovation possible.</p>
        </div>
    </section>

    <!-- What AI Can Do vs. What Humans Must Do -->
    <section class="comparison-section">
        <h2 class="section-title">What AI Can Do vs. What Humans Must Do</h2>

        <div class="comparison-grid">
            <div class="comparison-card">
                <h3>AI can:</h3>
                <ul>
                    <li>generate options</li>
                    <li>simulate outcomes</li>
                    <li>execute tasks</li>
                    <li>correct mistakes</li>
                    <li>plan optimally</li>
                    <li>scale instantly</li>
                </ul>
            </div>

            <div class="comparison-card highlight">
                <h3>AI cannot:</h3>
                <ul>
                    <li>set the frame</li>
                    <li>justify why to act (problem)</li>
                    <li>choose what to optimize (objective)</li>
                    <li>accept the tradeoff</li>
                    <li>make binding commitment</li>
                    <li>be a decision owner</li>
                </ul>
            </div>
        </div>

        <p class="section-conclusion">
            <strong>Direction is human.<br>
            Execution is machine.<br>
            HAP keeps the boundary intact.</strong>
        </p>
    </section>

    <!-- The HAP Checkpoints -->
    <section class="checkpoints-section">
        <h2 class="section-title">The Six Human Gates</h2>
        <p class="section-intro">AI can simulate a thousand paths, but it cannot open the gate to any of them. HAP enforces these mandatory preconditions before any execution begins.</p>

        <div class="checkpoints">
            <div class="checkpoint">
                <div class="checkpoint-content">
                    <h4>Frame — The Boundary</h4>
                    <p>Humans define what we are deciding. AI has no context until a human sets the decision boundary.</p>
                </div>
            </div>

            <div class="checkpoint">
                <div class="checkpoint-content">
                    <h4>Problem — The Justification</h4>
                    <p>Every action needs a reason. AI calculates solutions; only humans determine if the problem is worth solving.</p>
                </div>
            </div>

            <div class="checkpoint">
                <div class="checkpoint-content">
                    <h4>Objective — The Optimization</h4>
                    <p>AI optimizes for any metric. Only humans can choose which outcome actually matters.</p>
                </div>
            </div>

            <div class="checkpoint">
                <div class="checkpoint-content">
                    <h4>Tradeoff — The Cost</h4>
                    <p>Every choice abandons alternatives. Only humans can accept the loss of what is sacrificed.</p>
                </div>
            </div>

            <div class="checkpoint">
                <div class="checkpoint-content">
                    <h4>Commitment — The Point of No Return</h4>
                    <p>Commitment makes a choice binding. Only a human can make an AI action irreversible.</p>
                </div>
            </div>

            <div class="checkpoint">
                <div class="checkpoint-content">
                    <h4>Decision Owner — The Responsibility</h4>
                    <p>Authorship and Ownership are unified. No action is taken without an identifiable human who bears the consequences.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- How HAP Works -->
    <section class="how-it-works">
        <h2 class="section-title">How HAP Works</h2>
        <h3 class="mechanism-title">Stop → Ask → Confirm → Proceed</h3>

        <div class="steps">
            <div class="step">
                <div class="step-number">1</div>
                <h4>Stop</h4>
                <p>AI detects missing or ambiguous decision states: frame, problem, objective, tradeoff, commitment, or decision owner.</p>
            </div>

            <div class="step">
                <div class="step-number">2</div>
                <h4>Ask</h4>
                <p>HAP triggers a structured question that forces human direction.</p>
            </div>

            <div class="step">
                <div class="step-number">3</div>
                <h4>Confirm</h4>
                <p>The human confirms the decision the AI must follow.</p>
            </div>

            <div class="step">
                <div class="step-number">4</div>
                <h4>Proceed</h4>
                <p>Only then does the system continue.</p>
            </div>
        </div>

        <p class="section-conclusion">
            <strong>No skipping.<br>
            No inference.<br>
            No silent automation.</strong>
        </p>
    </section>

    <!-- Governance Enforced, Not Documented -->
    <section class="compliance-section">
        <h2 class="section-title">Governance Enforced, Not Documented</h2>
        <h3 class="compliance-subtitle">Most AI governance frameworks share the same core requirement: humans must remain in control of consequential AI decisions.</h3>

        <div class="section-body">
            <p>The EU AI Act mandates it. ISO 42001 requires it. NIST AI RMF recommends it. But none of them say <strong>how</strong>.</p>
            <p>HAP is the how. It enforces human oversight at the protocol level — not through policies that can be ignored, but through cryptographic gates that cannot be bypassed.</p>
        </div>

        <div class="compliance-grid">
            <div class="compliance-card">
                <h3>Enforceable by Design</h3>
                <p>Every AI action requires a human Decision Owner who has articulated the problem, objective, and tradeoffs. No attestation, no execution.</p>
            </div>
            <div class="compliance-card">
                <h3>EU AI Act Ready</h3>
                <p>Article 14 mandates effective human oversight for high-risk AI. HAP satisfies this structurally — oversight is not a checkbox, it's the architecture.</p>
            </div>
            <div class="compliance-card">
                <h3>Audit-Ready Infrastructure</h3>
                <p>Every decision produces a cryptographic trail of authorship, tradeoffs, and commitments — tamper-proof and verifiable.</p>
            </div>
        </div>
    </section>

    <!-- Why This Matters Now -->
    <section class="matters-now">
        <h2 class="section-title">Why This Matters Now</h2>
        <div class="matters-content">
            <p>As AI accelerates, execution becomes free.<br>Abundance becomes default.</p>
            <p class="key-insight">The real scarcity becomes <strong>human direction</strong> — decisions that commit someone and shape a trajectory.</p>
            <p>If humans stop making the hard calls, machines will make them by default — quietly, through convenience.</p>
            <p class="conclusion">HAP is the infrastructure that keeps direction human.</p>
        </div>
    </section>

    <!-- Build With HAP -->
    <section class="protocol-nav" id="protocol">
        <h2 class="section-title">Build With HAP</h2>

        <div class="protocol-links">
            <a href="/protocol" class="protocol-link">
                <div class="label">Protocol</div>
                <h3>Protocol</h3>
                <p>How direction is described, measured, and enforced</p>
                <div class="arrow">Read the protocol →</div>
            </a>

            <a href="/integration" class="protocol-link">
                <div class="label">Integration</div>
                <h3>Integration</h3>
                <p>How to integrate HAP into your systems</p>
                <div class="arrow">Read integration guide →</div>
            </a>

            <a href="https://demo.humanagencyprotocol.org/" target="_blank" rel="noopener noreferrer" class="protocol-link">
                <div class="label">Demo</div>
                <h3>Demo</h3>
                <p>See HAP enforcement in action</p>
                <div class="arrow">Try the demo →</div>
            </a>

            <a href="/service" class="protocol-link">
                <div class="label">Service Providers</div>
                <h3>Service Providers</h3>
                <p>Verified infrastructure enforcing compliance</p>
                <div class="arrow">View architecture →</div>
            </a>

            <a href="/governance" class="protocol-link">
                <div class="label">Governance</div>
                <h3>Governance</h3>
                <p>Transparent, federated oversight</p>
                <div class="arrow">Read framework →</div>
            </a>
        </div>

        <p class="section-conclusion" style="margin-top: 3rem; text-align: left;">
            <strong>HAP turns human direction into the governing layer of intelligent systems.</strong>
        </p>
    </section>

</BaseLayout>

<style>
    /* Hero Section */
    .hero {
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center; /* Keep the 1200px container centered in viewport */
        padding: 9rem 1.5rem 4rem;
    }

    .hero-content {
        max-width: 1200px;
        width: 100%;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: flex-start; /* Force all children to the left */
    }

    @media (min-width: 1280px) {
        .hero-content{
        padding: 0 1.5rem;
        }
    }


    .hero h1 {
        font-size: clamp(2.2rem, 5vw, 4rem);
        font-weight: 700;
        line-height: 1.1;
        letter-spacing: -0.03em;
        max-width: 980px;
        margin-bottom: 2rem;
        text-align: left;
    }

    .hero .highlight {
        color: var(--accent);
    }

    .hero-subtitle {
        font-size: clamp(1.2rem, 2.2vw, 1.6rem);
        font-weight: 600;
        color: var(--text-primary);
        max-width: 800px;
        margin-bottom: 1.5rem;
        line-height: 1.3;
        text-align: left;
    }

    .hero-tagline {
        font-size: clamp(1rem, 1.8vw, 1.3rem);
        font-weight: 600;
        color: var(--accent);
        max-width: 900px;
        margin-bottom: 1.5rem;
        line-height: 1.4;
        text-align: left;
    }

    .hero-body {
        max-width: 800px;
        margin-bottom: 2.5rem;
        text-align: left;
    }

    .hero-body p {
        font-size: clamp(0.95rem, 1.6vw, 1.15rem);
        line-height: 1.6;
        margin-bottom: 1rem;
        color: var(--text-primary);
    }

    .key-statement {
        font-size: clamp(1.05rem, 1.8vw, 1.25rem);
        font-weight: 600;
        color: var(--text-primary);
        margin: 1.2rem 0;
        max-width: 600px;
    }

    @media (max-height: 700px) {
        .hero {
            min-height: auto;
            padding-top: 7rem;
            padding-bottom: 3rem;
        }
        .hero h1 {
            margin-bottom: 1.5rem;
        }
    }

    .emphasis {
        font-weight: 600;
        color: var(--accent);
    }

    .cta-group {
        display: flex;
        gap: 1rem;
        flex-wrap: wrap;
        justify-content: flex-start;
    }

    .btn.clicked {
        opacity: 0.7;
    }

    /* Card Selector Styles */
    .card-section {
        width: 100%;
        max-width: 1000px;
        margin-top: 2rem;
        animation: slideDown 0.3s ease-out;
        text-align: left;
    }

    .card-section-title {
        font-size: clamp(1.2rem, 2.2vw, 1.6rem);
        font-weight: 600;
        text-align: left;
        margin-bottom: 3rem;
        line-height: 1.3;
        color: var(--text-primary);
    }

    .cards-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 1.5rem;
        margin-bottom: 2rem;
        justify-content: center;
        align-items: stretch;
        width: 100%;
        max-width: 1200px; /* Limit overall width */
        margin-left: auto;
        margin-right: auto;
    }

    .use-case-card {
        background: var(--bg-elevated);
        border: 2px solid var(--border);
        border-radius: 0.75rem;
        padding: 2rem;
        text-align: left;
        cursor: pointer;
        transition: all 0.2s ease;
        position: relative;
        width: 100%;
        max-width: 300px;
        margin: 0 auto;
        justify-self: center; /* Actually center the item within its grid cell */
    }

    .use-case-card:hover {
        border-color: var(--accent);
        transform: translateY(-4px);
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
    }

    .use-case-card.active {
        border-color: var(--accent);
        background: var(--bg);
    }

    .wildcard-card {
        border-style: dashed;
    }

    /* Or Separator */
    .or-separator {
        grid-column: 1 / -1;
        display: flex;
        align-items: center;
        margin: 2rem 0;
        text-align: center;
    }

    .or-separator::before,
    .or-separator::after {
        content: '';
        flex: 1;
        border-top: 1px solid var(--border);
    }

    .or-text {
        background: var(--bg);
        padding: 0 1rem;
        color: var(--text-secondary);
        font-weight: 600;
        white-space: nowrap;
    }

    .card-title {
        font-size: 1.25rem;
        font-weight: 600;
        margin-bottom: 0.75rem;
        color: var(--text-primary);
    }

    .card-description {
        font-size: 0.95rem;
        color: var(--text-secondary);
        line-height: 1.5;
        margin: 0;
    }

    .card-badge {
        display: inline-block;
        font-size: 0.7rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.06em;
        color: var(--accent);
        border: 1px solid var(--accent);
        border-radius: 0.25rem;
        padding: 0.15rem 0.5rem;
        margin-top: 0.75rem;
    }

    .demo-link {
        background: var(--accent-subtle);
        border: 1px solid var(--accent);
        border-radius: 0.5rem;
        padding: 0.75rem 1rem;
        text-align: center;
    }

    .demo-link a {
        color: var(--accent);
        font-weight: 600;
        text-decoration: none;
    }

    .demo-link a:hover {
        text-decoration: underline;
    }

    /* Wildcard Input */
    .wildcard-label {
        display: block;
        font-size: 1rem;
        font-weight: 500;
        color: var(--text-primary);
        margin-bottom: 0.75rem;
    }

    .wildcard-input {
        width: 100%;
        min-height: 120px;
        padding: 1rem;
        font-size: 1rem;
        font-family: inherit;
        border: 2px solid var(--border);
        border-radius: 0.5rem;
        background: var(--bg);
        color: var(--text-primary);
        resize: vertical;
        margin-bottom: 1rem;
    }

    .wildcard-input:focus {
        outline: none;
        border-color: var(--accent);
    }

    /* Prompt Display */
    .prompt-intro {
        font-size: 1rem;
        color: var(--text-secondary);
        margin-bottom: 1.5rem;
        text-align: center;
    }

    .prompt-box {
        background: var(--bg);
        border: 1px solid var(--border);
        border-radius: 0.5rem;
        padding: 1.5rem;
        margin-bottom: 1.5rem;
        overflow-x: auto;
    }

    .prompt-text {
        font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Courier New', monospace;
        font-size: 0.9rem;
        line-height: 1.6;
        color: var(--text-primary);
        white-space: pre-wrap;
        word-wrap: break-word;
        margin: 0;
        padding: 0;
        background: transparent;
        border: none;
        border-radius: 0;
    }

    .prompt-actions {
        display: flex;
        justify-content: center;
        margin-bottom: 1.5rem;
    }

    .prompt-note {
        font-size: 0.9rem;
        color: var(--text-tertiary);
        text-align: center;
        line-height: 1.6;
        margin: 0;
    }

    .prominent-note {
        background: var(--bg-elevated);
        border: 2px solid var(--accent);
        border-radius: 0.5rem;
        padding: 1rem;
        margin: 1.5rem 0;
        font-weight: 500;
        color: var(--text-primary);
        font-size: clamp(1.05rem, 2vw, 1.2rem);
        line-height: 1.6;
    }

    .prominent-note a {
        color: var(--accent);
        text-decoration: none;
    }

    .prominent-note a:hover {
        text-decoration: underline;
    }

    .prompt-note a {
        color: var(--accent);
        text-decoration: none;
    }

    .prompt-note a:hover {
        text-decoration: underline;
    }

    .prompt-display {
        background: var(--bg-elevated);
        border: 2px solid var(--accent);
        border-radius: 0.75rem;
        padding: 1.5rem;
        margin-top: 1rem;
        animation: slideDown 0.3s ease-out;
    }

    .prompt-content {
        display: flex;
        flex-direction: column;
        gap: 1rem;
    }


    /* Content Sections */

    .section-body {
        max-width: 800px;
    }

    .section-body p {
        font-size: clamp(1.05rem, 2vw, 1.2rem);
        line-height: 1.8;
        margin-bottom: 1.5rem;
        color: var(--text-primary);
    }

    .axiom-block {
        font-size: clamp(1.2rem, 2.5vw, 1.6rem);
        font-weight: 600;
        font-style: italic;
        color: var(--text-primary);
        border-left: 4px solid var(--accent);
        padding: 1.5rem 2rem;
        margin: 3rem 0;
        background: var(--bg-elevated);
        line-height: 1.5;
    }

    /* Comparison Section */
    .content-section {
        max-width: 1200px;
        margin: 8rem auto;
        padding: 0 1.5rem;
    }

    /* Comparison Section */
    .comparison-section {
        max-width: 1200px;
        margin: 8rem auto;
        padding: 0 1.5rem;
    }

    .comparison-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 2rem;
        margin: 3rem 0;
    }

    .comparison-card {
        background: var(--bg-elevated);
        border: 2px solid var(--border);
        border-radius: 1rem;
        padding: 2.5rem;
    }

    .comparison-card.highlight {
        border-color: var(--accent);
        background: var(--accent-subtle);
    }

    .comparison-card h3 {
        font-size: 1.5rem;
        font-weight: 600;
        margin-bottom: 1.5rem;
        color: var(--text-primary);
    }

    .comparison-card ul {
        list-style: none;
        padding: 0;
        margin: 0;
    }

    .comparison-card li {
        padding: 0.75rem 0;
        border-bottom: 1px solid var(--border);
        color: var(--text-primary);
        line-height: 1.6;
        font-size: clamp(1rem, 1.8vw, 1.1rem);
    }

    .comparison-card li:last-child {
        border-bottom: none;
    }

    .section-conclusion {
        font-size: clamp(1.2rem, 2.2vw, 1.4rem);
        font-weight: 600;
        color: var(--accent);
        margin-top: 3rem;
        max-width: 800px;
        line-height: 1.6;
    }

    /* Checkpoints Section */
    .checkpoints-section {
        max-width: 1200px;
        margin: 8rem auto;
        padding: 0 1.5rem;
    }

    .section-intro {
        font-size: clamp(1.05rem, 2vw, 1.2rem);
        color: var(--text-primary);
        margin-bottom: 1rem;
        max-width: 800px;
        line-height: 1.7;
    }

    .checkpoints {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 1.5rem;
        margin-top: 3rem;
        max-width: 1200px;
    }

    .checkpoint {
        background: var(--bg-elevated);
        border: 2px solid var(--border);
        border-radius: 1rem;
        padding: 2rem;
        display: flex;
        align-items: flex-start;
        gap: 2rem;
    }

    .checkpoint-number {
        width: 3rem;
        height: 3rem;
        background: var(--accent);
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        font-weight: 700;
        flex-shrink: 0;
    }

    .checkpoint-content h4 {
        font-size: 1.3rem;
        font-weight: 600;
        margin-bottom: 0.75rem;
        color: var(--text-primary);
    }

    .checkpoint-content p {
        color: var(--text-secondary);
        margin: 0;
        line-height: 1.6;
    }

    /* How It Works */
    .how-it-works {
        max-width: 1200px;
        margin: 8rem auto;
        padding: 0 1.5rem;
    }

    .mechanism-title {
        font-size: clamp(1.5rem, 3vw, 2rem);
        font-weight: 600;
        color: var(--accent);
        margin-bottom: 3rem;
        text-align: center;
    }

    .steps {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 2rem;
        margin-bottom: 3rem;
    }

    .step {
        background: var(--bg-elevated);
        border: 2px solid var(--border);
        border-radius: 1rem;
        padding: 2.5rem 2rem;
        text-align: center;
    }

    .step-number {
        width: 3rem;
        height: 3rem;
        background: var(--accent);
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        font-weight: 700;
        margin: 0 auto 1.5rem;
    }

    .step h4 {
        font-size: 1.3rem;
        font-weight: 600;
        margin-bottom: 1rem;
        color: var(--text-primary);
    }

    .step p {
        color: var(--text-secondary);
        line-height: 1.6;
        margin-bottom: 0;
    }

    .enforcement-statement {
        font-size: clamp(1.2rem, 2vw, 1.4rem);
        font-weight: 600;
        color: var(--text-primary);
        margin-top: 2rem;
        text-align: center;
        line-height: 1.8;
    }

    /* Compliance Section */
    .compliance-section {
        max-width: 1200px;
        margin: 8rem auto;
        padding: 0 1.5rem;
    }

    .compliance-subtitle {
        font-size: clamp(1.3rem, 2.5vw, 1.8rem);
        font-weight: 600;
        color: var(--accent);
        margin-bottom: 2rem;
        max-width: 800px;
        line-height: 1.3;
    }

    .compliance-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 2rem;
        margin-top: 3rem;
    }

    .compliance-card {
        background: var(--bg-elevated);
        border: 2px solid var(--border);
        border-radius: 1rem;
        padding: 2rem;
    }

    /* Compliance Section */
    .compliance-section {
        max-width: 1200px;
        margin: 8rem auto;
        padding: 0 1.5rem;
    }

    .compliance-subtitle {
        font-size: clamp(1.3rem, 2.5vw, 1.8rem);
        font-weight: 600;
        color: var(--accent);
        margin-bottom: 2rem;
        max-width: 800px;
        line-height: 1.3;
    }

    .compliance-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 2rem;
        margin-top: 3rem;
    }

    .compliance-card {
        background: var(--bg-elevated);
        border: 2px solid var(--border);
        border-radius: 1rem;
        padding: 2.5rem;
    }

    .compliance-card h3 {
        font-size: 1.3rem;
        font-weight: 600;
        margin-bottom: 1rem;
        color: var(--text-primary);
    }

    .compliance-card p {
        color: var(--text-secondary);
        line-height: 1.7;
        font-size: clamp(1rem, 1.8vw, 1.1rem);
        margin: 0;
    }

    /* Why This Matters Now */
    .matters-now {
        max-width: 1200px;
        margin: 8rem auto;
        padding: 0 1.5rem;
    }

    .matters-content {
        max-width: 800px;
    }

    .matters-content p {
        font-size: clamp(1.05rem, 2vw, 1.2rem);
        line-height: 1.8;
        margin-bottom: 1.5rem;
        color: var(--text-primary);
    }

    .key-insight {
        font-size: clamp(1.15rem, 2.2vw, 1.35rem);
        font-weight: 600;
        color: var(--text-primary);
        margin: 2rem 0;
    }

    .matters-content .emphasis {
        font-size: clamp(1.2rem, 2.2vw, 1.4rem);
        display: block;
        margin: 2rem 0;
    }

    .conclusion {
        font-size: clamp(1.2rem, 2.2vw, 1.4rem);
        font-weight: 600;
        color: var(--accent);
        margin-top: 2rem;
    }

    /* What HAP Enables */
    .enables-section {
        max-width: 1200px;
        margin: 8rem auto;
        padding: 0 1.5rem;
    }

    .enables-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 2rem;
        margin-top: 3rem;
    }

    .enable-card {
        background: var(--bg-elevated);
        border: 2px solid var(--border);
        border-radius: 1rem;
        padding: 2.5rem;
    }

    .enable-card.highlight {
        border-color: var(--accent);
        background: var(--accent-subtle);
    }

    .enable-card h3 {
        font-size: 1.3rem;
        font-weight: 600;
        margin-bottom: 1rem;
        color: var(--accent);
    }

    .enable-card p {
        color: var(--text-primary);
        line-height: 1.7;
        font-size: clamp(1rem, 1.8vw, 1.1rem);
        margin: 0;
    }

    .enables-principles {
        margin-top: 3rem;
        padding-top: 2rem;
        border-top: 2px solid var(--border);
    }

    .enables-principles .key-statement {
        font-size: clamp(1.1rem, 2vw, 1.3rem);
        margin-bottom: 1.5rem;
        line-height: 1.6;
    }

    /* Shared Styles */
    .section-title {
        font-size: clamp(2rem, 4vw, 3rem);
        font-weight: 700;
        letter-spacing: -0.02em;
        margin-bottom: 2rem;
        max-width: 800px;
    }

    /* Documentation */
    .protocol-nav {
        max-width: 1200px;
        margin: 8rem auto;
        padding: 0 1.5rem;
    }

    .protocol-links {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 1.5rem;
        margin-top: 3rem;
    }

    .protocol-link {
        background: var(--bg-elevated);
        border: 1px solid var(--border);
        border-radius: 0.75rem;
        padding: 2rem;
        text-decoration: none;
        color: inherit;
        transition: all 0.3s;
        display: block;
    }

    .protocol-link:hover {
        border-color: var(--accent);
        background: var(--accent-subtle);
        transform: translateY(-4px);
        box-shadow: 0 12px 40px rgba(0, 0, 0, 0.08);
    }

    @media (prefers-color-scheme: dark) {
        .protocol-link:hover {
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.3);
        }
    }

    .protocol-link .label {
        font-size: 0.8rem;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        color: var(--text-tertiary);
        margin-bottom: 0.5rem;
    }

    .protocol-link h3 {
        font-size: 1.25rem;
        font-weight: 600;
        margin-bottom: 0.75rem;
    }

    .protocol-link p {
        color: var(--text-secondary);
        line-height: 1.7;
    }

    .protocol-link .arrow {
        margin-top: 1rem;
        color: var(--accent);
        font-weight: 600;
    }

    /* Responsive */
    @media (max-width: 1024px) and (min-width: 769px) {
        .checkpoints {
            grid-template-columns: repeat(2, 1fr);
        }
    }

    @media (max-width: 768px) {
        .hero {
            padding-top: 8rem;
            min-height: auto;
        }

        .cta-group {
            flex-direction: column;
        }

        .btn {
            text-align: center;
        }

        .content-section,
        .comparison-section,
        .checkpoints-section,
        .how-it-works,
        .matters-now,
        .enables-section {
            margin: 4rem auto;
        }

        .steps {
            grid-template-columns: 1fr;
        }

        .comparison-grid {
            grid-template-columns: 1fr;
        }

        .checkpoint {
            flex-direction: column;
            text-align: center;
        }

        .checkpoints {
            grid-template-columns: 1fr;
        }
    }
</style>

<script>
    const prompts = {
        development: {
            showDemo: true,
            prompt: `Explain how the Human Agency Protocol (HAP) can be used to prevent production deployments unless engineering and release owners explicitly commit to the problem being solved, the intended outcome, the deployment path, and the risks. Use concrete examples from a typical CI/CD pipeline.`
        },
        agents: {
            prompt: `Explain how the Human Agency Protocol (HAP) can be used to define and enforce human-approved bounds for AI agents, where agents operate freely inside those bounds but must obtain new human attestation before expanding scope or performing higher-risk actions.`
        },
        infrastructure: {
            prompt: `Explain how the Human Agency Protocol (HAP) can gate infrastructure automation (Terraform, Kubernetes, DNS, IAM) so that production changes cannot execute unless the appropriate domain owners explicitly commit and accept responsibility.`
        },
        database: {
            prompt: `Explain how the Human Agency Protocol (HAP) can be applied to database migrations, destructive queries, and sensitive data exports so these actions are blocked until a named human explicitly commits and accepts the tradeoffs.`
        },
        financial: {
            prompt: `Explain how the Human Agency Protocol (HAP) can be used to gate financial operations such as payments, refunds, transfers, and spending limits so that automation cannot move money without human attestation.`
        },
        access: {
            prompt: `Explain how the Human Agency Protocol (HAP) can be used to control access and identity changes (permission grants, role escalations, account creation) so they require explicit human commitment before execution.`
        },
        security: {
            prompt: `Explain how the Human Agency Protocol (HAP) can be applied to security-sensitive actions (firewall changes, secret rotation, auth configuration, vulnerability mitigations) so execution requires explicit security owner commitment.`
        },
        product: {
            prompt: `Explain how the Human Agency Protocol (HAP) can be used to gate customer-facing product changes so that features, behavior changes, and large experiments cannot ship without a product owner explicitly committing to the outcome and risks.`
        },
        compliance: {
            prompt: `Explain how the Human Agency Protocol (HAP) can provide cryptographic, audit-ready proof that humans exercised required oversight for high-risk AI and automation actions in regulated environments.`
        }
    };

    let selectedCard = null;
    let contextText = null;

    // Fetch context text
    async function fetchContext() {
        if (!contextText) {
            const response = await fetch('/context.txt');
            contextText = await response.text();
        }
        return contextText;
    }

    // Copy text to clipboard with fallback
    async function copyToClipboard(text) {
        if (navigator.clipboard && navigator.clipboard.writeText) {
            try {
                await navigator.clipboard.writeText(text);
                return true;
            } catch (e) {
                // fall through to fallback
            }
        }
        const textarea = document.createElement('textarea');
        textarea.value = text;
        textarea.style.position = 'absolute';
        textarea.style.left = '-9999px';
        document.body.appendChild(textarea);
        textarea.select();
        const ok = document.execCommand('copy');
        document.body.removeChild(textarea);
        return ok;
    }

    // Show "Copied!" feedback on a button
    function showCopied(button, originalText) {
        button.textContent = 'Copied! Paste it in your AI chat';
        button.disabled = true;
        setTimeout(() => {
            button.textContent = originalText;
            button.disabled = false;
        }, 3000);
    }

    // Toggle card section
    document.getElementById('ask-ai-btn')?.addEventListener('click', async () => {
        const button = document.getElementById('ask-ai-btn');
        const cardSection = document.getElementById('card-section');

        if (cardSection.style.display === 'none' || !cardSection.style.display) {
            button.classList.add('clicked');
            cardSection.style.display = 'block';
            fetchContext(); // pre-fetch in background

            setTimeout(() => {
                const headerHeight = 80;
                const buttonTop = button.getBoundingClientRect().top + window.scrollY - headerHeight;
                window.scrollTo({ top: buttonTop, behavior: 'smooth' });
            }, 100);
        } else {
            button.classList.remove('clicked');
            cardSection.style.display = 'none';
        }
    });

    // Handle card selection
    document.querySelectorAll('[data-card]').forEach(card => {
        card.addEventListener('click', () => {
            const cardId = card.dataset.card;
            selectedCard = cardId;

            // Update active state
            document.querySelectorAll('[data-card]').forEach(c => c.classList.remove('active'));
            card.classList.add('active');

            const panel = document.getElementById('prompt-panel');
            const demoLink = document.getElementById('demo-link');
            const promptPreview = document.getElementById('prompt-preview');
            const promptText = document.getElementById('prompt-text');
            const contextLabel = document.getElementById('context-label');
            const contextInput = document.getElementById('context-input');
            const questionSection = document.getElementById('question-section');

            panel.style.display = 'block';

            if (cardId === 'question') {
                // Question mode: hide prompt preview, show question input
                demoLink.style.display = 'none';
                promptPreview.style.display = 'none';
                contextLabel.style.display = 'none';
                contextInput.style.display = 'none';
                questionSection.style.display = 'block';
            } else {
                // Use-case mode: show prompt preview + optional context
                const data = prompts[cardId];
                questionSection.style.display = 'none';

                demoLink.style.display = data.showDemo ? 'block' : 'none';
                promptPreview.style.display = 'block';
                promptText.textContent = data.prompt;

                contextLabel.style.display = 'block';
                contextInput.style.display = 'block';
                contextInput.value = '';
            }

            panel.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        });
    });

    // Copy prompt button
    document.getElementById('copy-btn')?.addEventListener('click', async () => {
        const button = document.getElementById('copy-btn');
        const originalText = button.textContent;

        button.textContent = 'Copying...';
        button.disabled = true;

        try {
            const context = await fetchContext();
            let combined;

            if (selectedCard === 'question') {
                // Question mode: question + HAP context
                const question = document.getElementById('question-input')?.value.trim();
                if (!question) {
                    alert('Please enter your question about HAP first.');
                    button.textContent = originalText;
                    button.disabled = false;
                    return;
                }
                combined = `You are an expert on the Human Agency Protocol (HAP).

User Question: "${question}"

Please provide a detailed answer based on the following HAP specification context:

${context}

Focus your response on answering the specific question while referencing relevant parts of the HAP specification.`;
            } else {
                // Use-case mode: prompt + optional user context + HAP context
                const promptText = document.getElementById('prompt-text')?.textContent;
                const userContext = document.getElementById('context-input')?.value.trim();

                combined = promptText;
                if (userContext) {
                    combined += `\n\nAdditional context from the user: ${userContext}`;
                }
                combined += `\n\nUse the following HAP specification as your primary reference:\n\n${context}`;
            }

            const ok = await copyToClipboard(combined);
            if (ok) {
                showCopied(button, originalText);
            } else {
                button.textContent = 'Copy failed. Try again.';
                setTimeout(() => { button.textContent = originalText; button.disabled = false; }, 3000);
            }
        } catch (error) {
            button.textContent = 'Copy failed. Try again.';
            setTimeout(() => { button.textContent = originalText; button.disabled = false; }, 3000);
        }
    });
</script>
