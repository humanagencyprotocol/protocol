---
import BaseLayout from '../layouts/BaseLayout.astro';
---

<BaseLayout title="HAP - The Human Direction Protocol">
    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-content">
        <h1>Execution is cheap. <br><span class="highlight">Direction is scarce.</span></h1>
        <h2 class="hero-subtitle">HAP is the protocol for human-authored direction. It ensures AI never executes without a Decision Owner.</h2>

        <div class="hero-body">
            <p>AI optimizes execution at machine speed, but it cannot author direction.<br>It scales the <strong>how</strong>, but only humans can decide the <strong>why</strong>.</p>
            <p class="key-statement"><strong><span class="highlight">Direction is the last human domain. HAP protects it.</span></strong></p>
        </div>

        <div class="cta-group">
            <button id="ask-ai-btn" class="btn btn-primary">Ask your AI about HAP</button>
            <a href="#why-exists" class="btn btn-secondary">Read more</a>
        </div>

        <!-- Discovery Engine -->
        <div id="persona-section" class="persona-section" style="display: none;">
            <!-- Step 1: Domain -->
            <p class="persona-intro">Create a prompt to learn more how you can use HAP for:</p>
            <div class="selection-grid domain-grid">
                <button class="selection-btn" data-domain="organizations">
                    <span class="selection-title">Organizations</span>
                </button>
                <button class="selection-btn" data-domain="cities">
                    <span class="selection-title">Cities</span>
                </button>
                <button class="selection-btn" data-domain="startups">
                    <span class="selection-title">Startups</span>
                </button>
            </div>

            <!-- Step 2: Lens (Hidden until domain selected) -->
            <div id="lens-selection" style="display: none; margin-top: 2rem;">
                <p class="persona-intro" id="lens-intro">Analyze this as...</p>
                <div class="selection-grid lens-grid" id="lens-options">
                    <!-- Default lenses for Organizations -->
                    <button class="selection-btn" data-lens="ceo" data-domains="organizations">
                        <span class="selection-title">CEO</span>
                    </button>
                    <button class="selection-btn" data-lens="cto" data-domains="organizations">
                        <span class="selection-title">CTO</span>
                    </button>
                    <button class="selection-btn" data-lens="legal" data-domains="organizations">
                        <span class="selection-title">Legal</span>
                    </button>
                    <button class="selection-btn" data-lens="hr" data-domains="organizations">
                        <span class="selection-title">HR</span>
                    </button>
                    <button class="selection-btn" data-lens="consultants" data-domains="organizations">
                        <span class="selection-title">Consultants</span>
                    </button>
                    <!-- Lenses for Cities -->
                    <button class="selection-btn" data-lens="mayor" data-domains="cities" style="display:none;">
                        <span class="selection-title">Mayor</span>
                    </button>
                    <button class="selection-btn" data-lens="city-planner" data-domains="cities" style="display:none;">
                        <span class="selection-title">City Planner</span>
                    </button>
                    <button class="selection-btn" data-lens="public-safety" data-domains="cities" style="display:none;">
                        <span class="selection-title">Public Safety</span>
                    </button>
                    <button class="selection-btn" data-lens="infrastructure" data-domains="cities" style="display:none;">
                        <span class="selection-title">Infrastructure</span>
                    </button>
                    <button class="selection-btn" data-lens="citizen-services" data-domains="cities" style="display:none;">
                        <span class="selection-title">Citizen Services</span>
                    </button>
                    <!-- Lenses for Startups -->
                    <button class="selection-btn" data-lens="healthcare" data-domains="startups" style="display:none;">
                        <span class="selection-title">Healthcare</span>
                    </button>
                    <button class="selection-btn" data-lens="finance" data-domains="startups" style="display:none;">
                        <span class="selection-title">Finance</span>
                    </button>
                    <button class="selection-btn" data-lens="education" data-domains="startups" style="display:none;">
                        <span class="selection-title">Education</span>
                    </button>
                    <button class="selection-btn" data-lens="relationships" data-domains="startups" style="display:none;">
                        <span class="selection-title">Relationships</span>
                    </button>
                    <button class="selection-btn" data-lens="personal-development" data-domains="startups" style="display:none;">
                        <span class="selection-title">Personal Development</span>
                    </button>
                </div>
            </div>

            <!-- Expanded Prompt Display -->
            <div id="prompt-display" class="prompt-display" style="display: none;">
                <div class="prompt-content">
                    <h4 id="prompt-title" class="prompt-title"></h4>
                    <p id="prompt-text" class="prompt-text"></p>
                    <div id="context-input-container">
                        <p class="context-label">Add your specific context (optional):</p>
                        <textarea id="context-input" class="context-input" placeholder=""></textarea>
                    </div>
                    <button id="copy-prompt-btn" class="btn btn-primary">Copy Discovery Prompt</button>
                </div>
            </div>
        </div>
        </div>
    </section>

    <!-- The Scarcity of Direction -->
    <section id="why-exists" class="content-section">
        <h2 class="section-title">The Scarcity of Direction</h2>
        <div class="section-body">
            <p>Modern AI doesn't wait. It predicts, escalates, and acts at machine speed. But without human leadership, AI moves into a <strong>decision vacuum—substituting statistical probability for the unique human innovation that creates real value.</strong></p>
            
            <p>To remain in control, we must enforce a fundamental boundary:</p>

            <blockquote class="axiom-block">
                “No consequential action may be taken in a human system without an identifiable human who has explicitly authorized it, understood its tradeoffs, and accepted responsibility for its outcomes.”
            </blockquote>

            <p>HAP turns this axiom into infrastructure. It ensures every action traces back to a human <strong>Decision Owner</strong> who provides the direction machine intelligence cannot duplicate. By forcing AI to pause at the point of irreversibility, HAP keeps authorship human and innovation possible.</p>
        </div>
    </section>

    <!-- What AI Can Do vs. What Humans Must Do -->
    <section class="comparison-section">
        <h2 class="section-title">What AI Can Do vs. What Humans Must Do</h2>

        <div class="comparison-grid">
            <div class="comparison-card">
                <h3>AI can:</h3>
                <ul>
                    <li>generate options</li>
                    <li>simulate outcomes</li>
                    <li>execute tasks</li>
                    <li>correct mistakes</li>
                    <li>plan optimally</li>
                    <li>scale instantly</li>
                </ul>
            </div>

            <div class="comparison-card highlight">
                <h3>AI cannot:</h3>
                <ul>
                    <li>set the frame</li>
                    <li>justify why to act (problem)</li>
                    <li>choose what to optimize (objective)</li>
                    <li>accept the tradeoff</li>
                    <li>make binding commitment</li>
                    <li>be a decision owner</li>
                </ul>
            </div>
        </div>

        <p class="section-conclusion">
            <strong>Direction is human.<br>
            Execution is machine.<br>
            HAP keeps the boundary intact.</strong>
        </p>
    </section>

    <!-- The HAP Checkpoints -->
    <section class="checkpoints-section">
        <h2 class="section-title">The Six Human Gates</h2>
        <p class="section-intro">AI can simulate a thousand paths, but it cannot open the gate to any of them. HAP enforces these mandatory preconditions before any execution begins.</p>

        <div class="checkpoints">
            <div class="checkpoint">
                <div class="checkpoint-content">
                    <h4>Frame — The Boundary</h4>
                    <p>Humans define what we are deciding. AI has no context until a human sets the decision boundary.</p>
                </div>
            </div>

            <div class="checkpoint">
                <div class="checkpoint-content">
                    <h4>Problem — The Justification</h4>
                    <p>Every action needs a reason. AI calculates solutions; only humans determine if the problem is worth solving.</p>
                </div>
            </div>

            <div class="checkpoint">
                <div class="checkpoint-content">
                    <h4>Objective — The Optimization</h4>
                    <p>AI optimizes for any metric. Only humans can choose which outcome actually matters.</p>
                </div>
            </div>

            <div class="checkpoint">
                <div class="checkpoint-content">
                    <h4>Tradeoff — The Cost</h4>
                    <p>Every choice abandons alternatives. Only humans can accept the loss of what is sacrificed.</p>
                </div>
            </div>

            <div class="checkpoint">
                <div class="checkpoint-content">
                    <h4>Commitment — The Point of No Return</h4>
                    <p>Commitment makes a choice binding. Only a human can make an AI action irreversible.</p>
                </div>
            </div>

            <div class="checkpoint">
                <div class="checkpoint-content">
                    <h4>Decision Owner — The Responsibility</h4>
                    <p>Authorship and Ownership are unified. No action is taken without an identifiable human who bears the consequences.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- How HAP Works -->
    <section class="how-it-works">
        <h2 class="section-title">How HAP Works</h2>
        <h3 class="mechanism-title">Stop → Ask → Confirm → Proceed</h3>

        <div class="steps">
            <div class="step">
                <div class="step-number">1</div>
                <h4>Stop</h4>
                <p>AI detects missing or ambiguous decision states: frame, problem, objective, tradeoff, commitment, or decision owner.</p>
            </div>

            <div class="step">
                <div class="step-number">2</div>
                <h4>Ask</h4>
                <p>HAP triggers a structured question that forces human direction.</p>
            </div>

            <div class="step">
                <div class="step-number">3</div>
                <h4>Confirm</h4>
                <p>The human confirms the decision the AI must follow.</p>
            </div>

            <div class="step">
                <div class="step-number">4</div>
                <h4>Proceed</h4>
                <p>Only then does the system continue.</p>
            </div>
        </div>

        <p class="enforcement-statement">
            <strong>No skipping.<br>
            No inference.<br>
            No silent automation.</strong>
        </p>
    </section>

    <!-- Compliant by Architecture -->
    <section class="compliance-section">
        <h2 class="section-title">Compliant by Architecture</h2>
        <h3 class="compliance-subtitle">Aligning with the EU AI Act—the global benchmark for AI governance.</h3>
        
        <div class="section-body">
            <p>The <strong>EU AI Act</strong> mandates that high-risk AI systems must be subject to effective human oversight (<strong>Article 14</strong>). HAP transforms this legal requirement from a policy checkbox into enforceable protocol behavior.</p>
        </div>

        <div class="compliance-grid">
            <div class="compliance-card">
                <h3>Verifiable Oversight</h3>
                <p>Directly satisfies regulatory mandates by ensuring AI never acts without an explicit "gate" opened by a human.</p>
            </div>
            <div class="compliance-card">
                <h3>Liability Protection</h3>
                <p>Closes the legal vacuum of "unowned" AI execution by cryptographically linking every action to a human Decision Owner.</p>
            </div>
            <div class="compliance-card">
                <h3>Audit-Ready Infrastructure</h3>
                <p>Provides a structural, tamper-proof trail of authorship, tradeoffs, and commitments for every consequence domain.</p>
            </div>
        </div>
    </section>

    <!-- Why This Matters Now -->
    <section class="matters-now">
        <h2 class="section-title">Why This Matters Now</h2>
        <div class="matters-content">
            <p>As AI accelerates, execution becomes free.<br>Abundance becomes default.</p>
            <p class="key-insight">The real scarcity becomes <strong>human direction</strong> — decisions that cost something, commit someone, and shape a trajectory.</p>
            <p class="emphasis">This is the last human value.</p>
            <p>If humans stop making the hard calls, machines will make them by default.<br>And once AI defines direction, human agency dissolves — quietly, through convenience.</p>
            <p class="conclusion">HAP is the boundary that preserves human authorship in an automated world.</p>
        </div>
    </section>

    <!-- What HAP Enables -->
    <section class="enables-section">
        <h2 class="section-title">What HAP Enables</h2>

        <div class="enables-grid">
            <div class="enable-card">
                <h3>Individuals</h3>
                <p>You stop drifting through AI-generated options and start defining what matters.</p>
            </div>

            <div class="enable-card">
                <h3>Teams</h3>
                <p>Alignment becomes real — because decisions require explicit, domain-scoped commitment from all affected decision owners.</p>
            </div>

            <div class="enable-card">
                <h3>Organizations</h3>
                <p>Strategy becomes human-led again. Authorship and ownership are unified across every consequence domain.</p>
            </div>

            <div class="enable-card highlight">
                <h3>Society</h3>
                <p>We preserve the one thing automation cannot replace:<br><strong>the human ability to choose a direction worth living for.</strong></p>
            </div>
        </div>

        <div class="enables-principles">
            <p class="key-statement"><strong>HAP assumes all execution bodies are untrusted.</strong><br>No human direction may be exposed to any executor (AGI, server, or human) until a valid attestation proves all six gates were closed under a recognized Blueprint.</p>

            <p class="key-statement"><strong>The Executor Proxy—not the executor—validates attestations.</strong><br>Executors receive only minimal, non-semantic instructions derived from pre-ratified decisions.</p>
        </div>
    </section>

    <!-- Build With HAP -->
    <section class="protocol-nav" id="protocol">
        <h2 class="section-title">Build With HAP</h2>

        <div class="protocol-links">
            <a href="/protocol" class="protocol-link">
                <div class="label">Protocol</div>
                <h3>Protocol</h3>
                <p>How direction is described, measured, and enforced</p>
                <div class="arrow">Read the protocol →</div>
            </a>

            <a href="/integration" class="protocol-link">
                <div class="label">SDK</div>
                <h3>SDK</h3>
                <p>Tools for integrating direction checkpoints</p>
                <div class="arrow">Explore the SDK →</div>
            </a>

            <a href="/service" class="protocol-link">
                <div class="label">Service Providers</div>
                <h3>Service Providers</h3>
                <p>Verified infrastructure enforcing compliance</p>
                <div class="arrow">View architecture →</div>
            </a>

            <a href="/governance" class="protocol-link">
                <div class="label">Governance</div>
                <h3>Governance</h3>
                <p>Transparent, federated oversight</p>
                <div class="arrow">Read framework →</div>
            </a>
        </div>

        <p class="section-conclusion" style="margin-top: 3rem; text-align: left;">
            <strong>HAP turns human direction into the governing layer of intelligent systems.</strong>
        </p>
    </section>

</BaseLayout>

<style>
    /* Hero Section */
    .hero {
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center; /* Keep the 1200px container centered in viewport */
        padding: 9rem 1.5rem 4rem;
    }

    .hero-content {
        max-width: 1200px;
        width: 100%;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: flex-start; /* Force all children to the left */
    }

    @media (min-width: 1280px) {
        .hero-content{
        padding: 0 1.5rem;
        }
    }


    .hero h1 {
        font-size: clamp(2.2rem, 5vw, 4rem);
        font-weight: 700;
        line-height: 1.1;
        letter-spacing: -0.03em;
        max-width: 980px;
        margin-bottom: 2rem;
        text-align: left;
    }

    .hero .highlight {
        color: var(--accent);
    }

    .hero-subtitle {
        font-size: clamp(1.2rem, 2.2vw, 1.6rem);
        font-weight: 600;
        color: var(--text-primary);
        max-width: 800px;
        margin-bottom: 1.5rem;
        line-height: 1.3;
        text-align: left;
    }

    .hero-tagline {
        font-size: clamp(1rem, 1.8vw, 1.3rem);
        font-weight: 600;
        color: var(--accent);
        max-width: 900px;
        margin-bottom: 1.5rem;
        line-height: 1.4;
        text-align: left;
    }

    .hero-body {
        max-width: 800px;
        margin-bottom: 2.5rem;
        text-align: left;
    }

    .hero-body p {
        font-size: clamp(0.95rem, 1.6vw, 1.15rem);
        line-height: 1.6;
        margin-bottom: 1rem;
        color: var(--text-primary);
    }

    .key-statement {
        font-size: clamp(1.05rem, 1.8vw, 1.25rem);
        font-weight: 600;
        color: var(--text-primary);
        margin: 1.2rem 0;
    }

    @media (max-height: 700px) {
        .hero {
            min-height: auto;
            padding-top: 7rem;
            padding-bottom: 3rem;
        }
        .hero h1 {
            margin-bottom: 1.5rem;
        }
    }

    .emphasis {
        font-weight: 600;
        color: var(--accent);
    }

    .cta-group {
        display: flex;
        gap: 1rem;
        flex-wrap: wrap;
        justify-content: flex-start;
    }

    .btn.clicked {
        opacity: 0.7;
    }

    /* Discovery Engine Styles */
    .persona-section {
        width: 100%;
        max-width: 1000px;
        margin-top: 2rem;
        animation: slideDown 0.3s ease-out;
        text-align: left;
    }

    .selection-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        gap: 1rem;
        margin-bottom: 1.5rem;
    }

    .selection-btn {
        background: var(--bg-elevated);
        border: 2px solid var(--border);
        border-radius: 0.75rem;
        padding: 1.25rem;
        cursor: pointer;
        transition: all 0.3s;
        text-align: center;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .selection-btn:hover {
        border-color: var(--accent);
        transform: translateY(-2px);
    }

    .selection-btn.active {
        background: var(--accent);
        border-color: var(--accent);
    }

    .selection-btn.active .selection-title {
        color: white;
    }

    .selection-title {
        font-size: 1rem;
        font-weight: 600;
        color: var(--text-primary);
    }

    .prompt-display {
        background: var(--bg-elevated);
        border: 2px solid var(--accent);
        border-radius: 0.75rem;
        padding: 1.5rem;
        margin-top: 1rem;
        animation: slideDown 0.3s ease-out;
    }

    .prompt-content {
        display: flex;
        flex-direction: column;
        gap: 1rem;
    }

    .prompt-title {
        font-size: 1.1rem;
        font-weight: 600;
        color: var(--accent);
        margin: 0;
    }

    .prompt-text {
        font-size: 0.95rem;
        line-height: 1.7;
        color: var(--text-primary);
        margin: 0;
        padding: 1rem;
        background: var(--bg);
        border-radius: 0.5rem;
        border-left: 3px solid var(--accent);
    }

    .custom-prompt-input {
        font-size: 0.95rem;
        line-height: 1.7;
        color: var(--text-primary);
        margin: 0;
        padding: 1rem;
        background: var(--bg);
        border-radius: 0.5rem;
        border: 2px solid var(--border);
        border-left: 3px solid var(--accent);
        font-family: inherit;
        resize: vertical;
        min-height: 120px;
        width: 100%;
        box-sizing: border-box;
    }

    .custom-prompt-input:focus {
        outline: none;
        border-color: var(--accent);
    }

    .context-label {
        font-size: 0.85rem;
        font-weight: 600;
        color: var(--text-secondary);
        margin-bottom: 0.5rem;
        margin-top: 1rem;
        text-transform: uppercase;
        letter-spacing: 0.05em;
    }

    .context-input {
        font-size: 0.95rem;
        line-height: 1.7;
        color: var(--text-primary);
        margin: 0 0 1rem 0;
        padding: 1rem;
        background: var(--bg);
        border-radius: 0.5rem;
        border: 2px solid var(--border);
        border-left: 3px solid var(--accent);
        font-family: inherit;
        resize: vertical;
        min-height: 100px;
        width: 100%;
        box-sizing: border-box;
    }

    .context-input:focus {
        outline: none;
        border-color: var(--accent);
    }

    /* Content Sections */

    .section-body {
        max-width: 800px;
    }

    .section-body p {
        font-size: clamp(1.05rem, 2vw, 1.2rem);
        line-height: 1.8;
        margin-bottom: 1.5rem;
        color: var(--text-primary);
    }

    .axiom-block {
        font-size: clamp(1.2rem, 2.5vw, 1.6rem);
        font-weight: 600;
        font-style: italic;
        color: var(--text-primary);
        border-left: 4px solid var(--accent);
        padding: 1.5rem 2rem;
        margin: 3rem 0;
        background: var(--bg-elevated);
        line-height: 1.5;
    }

    /* Comparison Section */
    .content-section {
        max-width: 1200px;
        margin: 8rem auto;
        padding: 0 1.5rem;
    }

    /* Comparison Section */
    .comparison-section {
        max-width: 1200px;
        margin: 8rem auto;
        padding: 0 1.5rem;
    }

    .comparison-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 2rem;
        margin: 3rem 0;
    }

    .comparison-card {
        background: var(--bg-elevated);
        border: 2px solid var(--border);
        border-radius: 1rem;
        padding: 2.5rem;
    }

    .comparison-card.highlight {
        border-color: var(--accent);
        background: var(--accent-subtle);
    }

    .comparison-card h3 {
        font-size: 1.5rem;
        font-weight: 600;
        margin-bottom: 1.5rem;
        color: var(--text-primary);
    }

    .comparison-card ul {
        list-style: none;
        padding: 0;
        margin: 0;
    }

    .comparison-card li {
        padding: 0.75rem 0;
        border-bottom: 1px solid var(--border);
        color: var(--text-primary);
        line-height: 1.6;
        font-size: clamp(1rem, 1.8vw, 1.1rem);
    }

    .comparison-card li:last-child {
        border-bottom: none;
    }

    .section-conclusion {
        font-size: clamp(1.2rem, 2.2vw, 1.4rem);
        font-weight: 600;
        color: var(--accent);
        margin-top: 3rem;
        max-width: 800px;
        line-height: 1.6;
    }

    /* Checkpoints Section */
    .checkpoints-section {
        max-width: 1200px;
        margin: 8rem auto;
        padding: 0 1.5rem;
    }

    .section-intro {
        font-size: clamp(1.05rem, 2vw, 1.2rem);
        color: var(--text-primary);
        margin-bottom: 1rem;
        max-width: 800px;
        line-height: 1.7;
    }

    .checkpoints {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 1.5rem;
        margin-top: 3rem;
        max-width: 1200px;
    }

    .checkpoint {
        background: var(--bg-elevated);
        border: 2px solid var(--border);
        border-radius: 1rem;
        padding: 2rem;
        display: flex;
        align-items: flex-start;
        gap: 2rem;
    }

    .checkpoint-number {
        width: 3rem;
        height: 3rem;
        background: var(--accent);
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        font-weight: 700;
        flex-shrink: 0;
    }

    .checkpoint-content h4 {
        font-size: 1.3rem;
        font-weight: 600;
        margin-bottom: 0.75rem;
        color: var(--text-primary);
    }

    .checkpoint-content p {
        color: var(--text-secondary);
        margin: 0;
        line-height: 1.6;
    }

    /* How It Works */
    .how-it-works {
        max-width: 1200px;
        margin: 8rem auto;
        padding: 0 1.5rem;
    }

    .mechanism-title {
        font-size: clamp(1.5rem, 3vw, 2rem);
        font-weight: 600;
        color: var(--accent);
        margin-bottom: 3rem;
        text-align: center;
    }

    .steps {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 2rem;
        margin-bottom: 3rem;
    }

    .step {
        background: var(--bg-elevated);
        border: 2px solid var(--border);
        border-radius: 1rem;
        padding: 2.5rem 2rem;
        text-align: center;
    }

    .step-number {
        width: 3rem;
        height: 3rem;
        background: var(--accent);
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        font-weight: 700;
        margin: 0 auto 1.5rem;
    }

    .step h4 {
        font-size: 1.3rem;
        font-weight: 600;
        margin-bottom: 1rem;
        color: var(--text-primary);
    }

    .step p {
        color: var(--text-secondary);
        line-height: 1.6;
        margin-bottom: 0;
    }

    .enforcement-statement {
        font-size: clamp(1.2rem, 2vw, 1.4rem);
        font-weight: 600;
        color: var(--text-primary);
        margin-top: 2rem;
        text-align: center;
        line-height: 1.8;
    }

    /* Compliance Section */
    .compliance-section {
        max-width: 1200px;
        margin: 8rem auto;
        padding: 0 1.5rem;
    }

    .compliance-subtitle {
        font-size: clamp(1.3rem, 2.5vw, 1.8rem);
        font-weight: 600;
        color: var(--accent);
        margin-bottom: 2rem;
        max-width: 800px;
        line-height: 1.3;
    }

    .compliance-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 2rem;
        margin-top: 3rem;
    }

    .compliance-card {
        background: var(--bg-elevated);
        border: 2px solid var(--border);
        border-radius: 1rem;
        padding: 2rem;
    }

    /* Compliance Section */
    .compliance-section {
        max-width: 1200px;
        margin: 8rem auto;
        padding: 0 1.5rem;
    }

    .compliance-subtitle {
        font-size: clamp(1.3rem, 2.5vw, 1.8rem);
        font-weight: 600;
        color: var(--accent);
        margin-bottom: 2rem;
        max-width: 800px;
        line-height: 1.3;
    }

    .compliance-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 2rem;
        margin-top: 3rem;
    }

    .compliance-card {
        background: var(--bg-elevated);
        border: 2px solid var(--border);
        border-radius: 1rem;
        padding: 2.5rem;
    }

    .compliance-card h3 {
        font-size: 1.3rem;
        font-weight: 600;
        margin-bottom: 1rem;
        color: var(--text-primary);
    }

    .compliance-card p {
        color: var(--text-secondary);
        line-height: 1.7;
        font-size: clamp(1rem, 1.8vw, 1.1rem);
        margin: 0;
    }

    /* Why This Matters Now */
    .matters-now {
        max-width: 1200px;
        margin: 8rem auto;
        padding: 0 1.5rem;
    }

    .matters-content {
        max-width: 800px;
    }

    .matters-content p {
        font-size: clamp(1.05rem, 2vw, 1.2rem);
        line-height: 1.8;
        margin-bottom: 1.5rem;
        color: var(--text-primary);
    }

    .key-insight {
        font-size: clamp(1.15rem, 2.2vw, 1.35rem);
        font-weight: 600;
        color: var(--text-primary);
        margin: 2rem 0;
    }

    .matters-content .emphasis {
        font-size: clamp(1.2rem, 2.2vw, 1.4rem);
        display: block;
        margin: 2rem 0;
    }

    .conclusion {
        font-size: clamp(1.2rem, 2.2vw, 1.4rem);
        font-weight: 600;
        color: var(--accent);
        margin-top: 2rem;
    }

    /* What HAP Enables */
    .enables-section {
        max-width: 1200px;
        margin: 8rem auto;
        padding: 0 1.5rem;
    }

    .enables-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 2rem;
        margin-top: 3rem;
    }

    .enable-card {
        background: var(--bg-elevated);
        border: 2px solid var(--border);
        border-radius: 1rem;
        padding: 2.5rem;
    }

    .enable-card.highlight {
        border-color: var(--accent);
        background: var(--accent-subtle);
    }

    .enable-card h3 {
        font-size: 1.3rem;
        font-weight: 600;
        margin-bottom: 1rem;
        color: var(--accent);
    }

    .enable-card p {
        color: var(--text-primary);
        line-height: 1.7;
        font-size: clamp(1rem, 1.8vw, 1.1rem);
        margin: 0;
    }

    .enables-principles {
        margin-top: 3rem;
        padding-top: 2rem;
        border-top: 2px solid var(--border);
    }

    .enables-principles .key-statement {
        font-size: clamp(1.1rem, 2vw, 1.3rem);
        margin-bottom: 1.5rem;
        line-height: 1.6;
    }

    /* Shared Styles */
    .section-title {
        font-size: clamp(2rem, 4vw, 3rem);
        font-weight: 700;
        letter-spacing: -0.02em;
        margin-bottom: 2rem;
        max-width: 800px;
    }

    /* Documentation */
    .protocol-nav {
        max-width: 1200px;
        margin: 8rem auto;
        padding: 0 1.5rem;
    }

    .protocol-links {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 1.5rem;
        margin-top: 3rem;
    }

    .protocol-link {
        background: var(--bg-elevated);
        border: 1px solid var(--border);
        border-radius: 0.75rem;
        padding: 2rem;
        text-decoration: none;
        color: inherit;
        transition: all 0.3s;
        display: block;
    }

    .protocol-link:hover {
        border-color: var(--accent);
        background: var(--accent-subtle);
        transform: translateY(-4px);
        box-shadow: 0 12px 40px rgba(0, 0, 0, 0.08);
    }

    @media (prefers-color-scheme: dark) {
        .protocol-link:hover {
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.3);
        }
    }

    .protocol-link .label {
        font-size: 0.8rem;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        color: var(--text-tertiary);
        margin-bottom: 0.5rem;
    }

    .protocol-link h3 {
        font-size: 1.25rem;
        font-weight: 600;
        margin-bottom: 0.75rem;
    }

    .protocol-link p {
        color: var(--text-secondary);
        line-height: 1.7;
    }

    .protocol-link .arrow {
        margin-top: 1rem;
        color: var(--accent);
        font-weight: 600;
    }

    /* Responsive */
    @media (max-width: 1024px) and (min-width: 769px) {
        .checkpoints {
            grid-template-columns: repeat(2, 1fr);
        }
    }

    @media (max-width: 768px) {
        .hero {
            padding-top: 8rem;
            min-height: auto;
        }

        .cta-group {
            flex-direction: column;
        }

        .btn {
            text-align: center;
        }

        .content-section,
        .comparison-section,
        .checkpoints-section,
        .how-it-works,
        .matters-now,
        .enables-section {
            margin: 4rem auto;
        }

        .steps {
            grid-template-columns: 1fr;
        }

        .comparison-grid {
            grid-template-columns: 1fr;
        }

        .checkpoint {
            flex-direction: column;
            text-align: center;
        }

        .checkpoints {
            grid-template-columns: 1fr;
        }
    }
</style>

<script>
    const domains = {
        organizations: {
            title: 'Organizations',
            context: 'enterprise governance, strategic oversight, and maintaining human accountability in AI-driven operations'
        },
        cities: {
            title: 'Cities',
            context: 'municipal governance, public safety, and ensuring AI systems serve citizen needs while maintaining democratic accountability'
        },
        startups: {
            title: 'Startups',
            context: 'product development, market positioning, and building AI-powered services that maintain human direction and user trust'
        }
    };

    const lenses = {
        ceo: {
            title: 'CEO',
            prompt: 'You are advising a CEO of an enterprise operating with increasing AI-driven automation. Explain clearly and concretely what the Human Agency Protocol (HAP) does for the organization: what it enforces, what it prevents, and how it changes decision-making and execution in practice. Focus on how HAP ensures that no consequential action—especially those involving AI systems—can occur without explicit human ownership and commitment. Explain why implementing this now is critical to maintaining strategic control, limiting liability, and preserving human accountability as AI systems become more autonomous.',
            placeholder: 'e.g. Our company needs to understand how HAP will affect our operations and strategy...'
        },
        cto: {
            title: 'CTO',
            prompt: 'You are advising a CTO of an organization increasingly dependent on AI systems. Explain clearly and concretely what the Human Agency Protocol (HAP) does for the technical architecture: what it enforces, what it prevents, and how it changes system design and implementation in practice. Focus on how HAP ensures that no AI execution can occur without explicit human authorization and cryptographic proof of commitment. Explain why implementing this now is critical to maintaining technical control, preventing system drift, and preserving human oversight as AI systems become more autonomous.',
            placeholder: 'e.g. We need to understand how HAP will affect our system architecture and development processes...'
        },
        legal: {
            title: 'Legal',
            prompt: 'You are advising a Legal Expert on an organization facing increasing AI integration. Explain clearly and concretely what the Human Agency Protocol (HAP) does for legal compliance: what it enforces, what it prevents, and how it changes liability and accountability in practice. Focus on how HAP ensures that no consequential AI action can occur without explicit human legal ownership and documented commitment. Explain why implementing this now is critical to limiting liability, ensuring regulatory compliance, and preserving legal accountability as AI systems become more autonomous.',
            placeholder: 'e.g. We need to understand how HAP will affect our legal compliance and liability exposure...'
        },
        hr: {
            title: 'HR',
            prompt: 'You are advising an HR Director of an organization adapting to AI-driven changes. Explain clearly and concretely what the Human Agency Protocol (HAP) does for workforce management: what it enforces, what it prevents, and how it changes employee development and accountability in practice. Focus on how HAP ensures that no consequential AI-driven HR action can occur without explicit human ownership and commitment. Explain why implementing this now is critical to preserving human agency in employment decisions, maintaining ethical standards, and ensuring workforce stability as AI systems become more autonomous.',
            placeholder: 'e.g. We need to understand how HAP will affect our HR processes and employee management...'
        },
        consultants: {
            title: 'Consultants',
            prompt: 'You are advising a Consultant helping organizations prepare for AI transformation. Explain clearly and concretely what the Human Agency Protocol (HAP) does for client organizations: what it enforces, what it prevents, and how it changes strategic decision-making and implementation in practice. Focus on how HAP ensures that no consequential AI action can occur without explicit human ownership and commitment. Explain why implementing this now is critical to maintaining strategic control, ensuring client accountability, and preserving human value creation as AI systems become more autonomous.',
            placeholder: 'e.g. I need to explain to clients how HAP will transform their approach to AI governance...'
        },
        mayor: {
            title: 'Mayor',
            prompt: 'You are advising a Mayor of a city increasingly dependent on AI systems. Explain clearly and concretely what the Human Agency Protocol (HAP) does for municipal governance: what it enforces, what it prevents, and how it changes public service delivery and accountability in practice. Focus on how HAP ensures that no consequential AI action in public services can occur without explicit human ownership and democratic commitment. Explain why implementing this now is critical to maintaining democratic accountability, preserving citizen trust, and ensuring public welfare as AI systems become more autonomous.',
            placeholder: 'e.g. We need to understand how HAP will affect our city services and democratic processes...'
        },
        'city-planner': {
            title: 'City Planner',
            prompt: 'You are advising a City Planner on urban systems increasingly managed by AI. Explain clearly and concretely what the Human Agency Protocol (HAP) does for urban planning: what it enforces, what it prevents, and how it changes development decisions and community impact in practice. Focus on how HAP ensures that no consequential urban AI action can occur without explicit human ownership and community commitment. Explain why implementing this now is critical to maintaining human-centered planning, preserving community values, and ensuring sustainable development as AI systems become more autonomous.',
            placeholder: 'e.g. We need to understand how HAP will affect our urban planning and development processes...'
        },
        'public-safety': {
            title: 'Public Safety',
            prompt: 'You are advising a Public Safety Official on systems increasingly reliant on AI. Explain clearly and concretely what the Human Agency Protocol (HAP) does for safety operations: what it enforces, what it prevents, and how it changes emergency response and risk management in practice. Focus on how HAP ensures that no consequential safety AI action can occur without explicit human ownership and life-and-death commitment. Explain why implementing this now is critical to maintaining human accountability, preserving safety standards, and ensuring public protection as AI systems become more autonomous.',
            placeholder: 'e.g. We need to understand how HAP will affect our emergency response and safety protocols...'
        },
        infrastructure: {
            title: 'Infrastructure',
            prompt: 'You are advising an Infrastructure Director on systems increasingly managed by AI. Explain clearly and concretely what the Human Agency Protocol (HAP) does for critical infrastructure: what it enforces, what it prevents, and how it changes system management and public safety in practice. Focus on how HAP ensures that no consequential infrastructure AI action can occur without explicit human ownership and public welfare commitment. Explain why implementing this now is critical to maintaining system reliability, preserving public safety, and ensuring infrastructure resilience as AI systems become more autonomous.',
            placeholder: 'e.g. We need to understand how HAP will affect our infrastructure management and safety systems...'
        },
        'citizen-services': {
            title: 'Citizen Services',
            prompt: 'You are advising a Citizen Services Director on public services increasingly delivered by AI. Explain clearly and concretely what the Human Agency Protocol (HAP) does for public service delivery: what it enforces, what it prevents, and how it changes service quality and citizen interaction in practice. Focus on how HAP ensures that no consequential citizen AI interaction can occur without explicit human ownership and service commitment. Explain why implementing this now is critical to maintaining human-centered services, preserving citizen dignity, and ensuring public trust as AI systems become more autonomous.',
            placeholder: 'e.g. We need to understand how HAP will affect our citizen services and public engagement...'
        },
        healthcare: {
            title: 'Healthcare',
            prompt: 'You are advising a Healthcare professional on systems increasingly assisted by AI. Explain clearly and concretely what the Human Agency Protocol (HAP) does for patient care: what it enforces, what it prevents, and how it changes medical decisions and patient safety in practice. Focus on how HAP ensures that no consequential medical AI action can occur without explicit human ownership and ethical commitment. Explain why implementing this now is critical to maintaining physician accountability, preserving patient safety, and ensuring ethical care as AI systems become more autonomous.',
            placeholder: 'e.g. We need to understand how HAP will affect our medical decisions and patient care processes...'
        },
        finance: {
            title: 'Finance',
            prompt: 'You are advising a Financial services professional on systems increasingly managed by AI. Explain clearly and concretely what the Human Agency Protocol (HAP) does for financial operations: what it enforces, what it prevents, and how it changes investment decisions and risk management in practice. Focus on how HAP ensures that no consequential financial AI action can occur without explicit human ownership and financial commitment. Explain why implementing this now is critical to maintaining regulatory compliance, preserving financial accountability, and ensuring stakeholder protection as AI systems become more autonomous.',
            placeholder: 'e.g. We need to understand how HAP will affect our financial decisions and risk management...'
        },
        education: {
            title: 'Education',
            prompt: 'You are advising an Educational professional on systems increasingly enhanced by AI. Explain clearly and concretely what the Human Agency Protocol (HAP) does for learning processes: what it enforces, what it prevents, and how it changes pedagogical decisions and student development in practice. Focus on how HAP ensures that no consequential educational AI action can occur without explicit human ownership and learning commitment. Explain why implementing this now is critical to maintaining pedagogical integrity, preserving teacher authority, and ensuring student growth as AI systems become more autonomous.',
            placeholder: 'e.g. We need to understand how HAP will affect our educational processes and student development...'
        },
        relationships: {
            title: 'Relationships',
            prompt: 'You are advising a professional developing Relationship tools on systems increasingly managed by AI. Explain clearly and concretely what the Human Agency Protocol (HAP) does for relationship management: what it enforces, what it prevents, and how it changes personal and professional connections in practice. Focus on how HAP ensures that no consequential relationship AI action can occur without explicit human ownership and emotional commitment. Explain why implementing this now is critical to maintaining authentic connections, preserving human agency, and ensuring meaningful relationships as AI systems become more autonomous.',
            placeholder: 'e.g. We need to understand how HAP will affect our relationship management and connection processes...'
        },
        'personal-development': {
            title: 'Personal Development',
            prompt: 'You are advising a Personal Development professional on systems increasingly guided by AI. Explain clearly and concretely what the Human Agency Protocol (HAP) does for individual growth: what it enforces, what it prevents, and how it changes self-direction and goal achievement in practice. Focus on how HAP ensures that no consequential personal development AI action can occur without explicit human ownership and growth commitment. Explain why implementing this now is critical to maintaining individual autonomy, preserving self-direction, and ensuring authentic personal growth as AI systems become more autonomous.',
            placeholder: 'e.g. We need to understand how HAP will affect our personal development and growth processes...'
        }
    };

    let currentDomain = null;
    let currentLens = null;
    let contextText = null;

    // Toggle Discovery Engine
    document.getElementById('ask-ai-btn')?.addEventListener('click', async () => {
        const button = document.getElementById('ask-ai-btn');
        const personaSection = document.getElementById('persona-section');
        if (personaSection.style.display === 'none' || !personaSection.style.display) {
            button.classList.add('clicked');
            personaSection.style.display = 'block';
            await fetchContext();
        } else {
            button.classList.remove('clicked');
            personaSection.style.display = 'none';
        }
    });

    // Handle Domain Selection
    document.querySelectorAll('[data-domain]').forEach(btn => {
        btn.addEventListener('click', () => {
            currentDomain = btn.dataset.domain;
            document.querySelectorAll('[data-domain]').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');

            // Show lens selection row
            const lensSelection = document.getElementById('lens-selection');
            if (lensSelection) lensSelection.style.display = 'block';

            // Show only the appropriate lens options for the selected domain
            updateLensOptions(currentDomain);

            updatePrompt();
        });
    });

    function updateLensOptions(domain) {
        // First, hide all lens options
        document.querySelectorAll('[data-domains]').forEach(lensBtn => {
            lensBtn.style.display = 'none';
        });

        // Then, show only the lens options for the selected domain
        document.querySelectorAll(`[data-domains="${domain}"]`).forEach(lensBtn => {
            lensBtn.style.display = 'flex';
        });

        // Update the lens intro text based on domain
        const lensIntro = document.getElementById('lens-intro');
        if (lensIntro) {
            if (domain === 'startups') {
                lensIntro.textContent = 'Develop service and apps for...';
            } else {
                lensIntro.textContent = 'Analyze this as...';
            }
        }
    }

    // Handle Lens Selection
    document.querySelectorAll('[data-lens]').forEach(btn => {
        btn.addEventListener('click', () => {
            currentLens = btn.dataset.lens;
            document.querySelectorAll('[data-lens]').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            
            // Show final prompt and context field
            const promptDisplay = document.getElementById('prompt-display');
            if (promptDisplay) promptDisplay.style.display = 'block';
            
            updatePrompt();
        });
    });

    function updatePrompt() {
        if (!currentDomain || !currentLens) return;

        const domainData = domains[currentDomain];
        const lensData = lenses[currentLens];
        const promptTitle = document.getElementById('prompt-title');
        const promptText = document.getElementById('prompt-text');
        const contextInput = document.getElementById('context-input') as HTMLTextAreaElement;

        if (promptTitle) promptTitle.textContent = `${domainData.title} + ${lensData.title}`;
        if (promptText) promptText.textContent = lensData.prompt.replace('[DOMAIN]', domainData.context);
        if (contextInput) {
            contextInput.placeholder = lensData.placeholder;
            // Hide context for newcomers as requested previously
            const container = document.getElementById('context-input-container');
            if (container) container.style.display = currentLens === 'newcomer' ? 'none' : 'block';
        }
        
        const display = document.getElementById('prompt-display');
        if (display) display.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }

    // Copy function (reusable)
    async function copyToClipboard(text, button, successMsg, originalText) {
        let copySucceeded = false;
        if (navigator.clipboard && navigator.clipboard.writeText) {
            try {
                await navigator.clipboard.writeText(text);
                copySucceeded = true;
            } catch (clipboardErr) {
                console.log('Clipboard API failed, trying fallback:', clipboardErr);
            }
        }
        if (!copySucceeded) {
            const textarea = document.createElement('textarea');
            textarea.value = text;
            textarea.style.position = 'absolute';
            textarea.style.left = '-9999px';
            textarea.style.top = '0';
            textarea.setAttribute('readonly', '');
            document.body.appendChild(textarea);
            textarea.select();
            try {
                copySucceeded = document.execCommand('copy');
            } catch (e) {
                console.error('execCommand failed:', e);
            }
            document.body.removeChild(textarea);
        }
        if (copySucceeded) {
            button.textContent = successMsg;
            setTimeout(() => {
                if (button) button.textContent = originalText;
            }, 3000);
        }
    }

    // Fetch context text
    async function fetchContext() {
        if (!contextText) {
            const response = await fetch('/context.txt');
            contextText = await response.text();
        }
        return contextText;
    }

    // Copy logic
    document.getElementById('copy-prompt-btn')?.addEventListener('click', async () => {
        const button = document.getElementById('copy-prompt-btn');
        const originalText = button.textContent;
        const context = await fetchContext();
        
        const domainData = domains[currentDomain];
        const lensData = lenses[currentLens];
        const userContext = (document.getElementById('context-input') as HTMLTextAreaElement).value.trim();
        
        const basePrompt = lensData.prompt.replace('[DOMAIN]', domainData.context);
        const personaPrompt = userContext 
            ? `${basePrompt}\n\nUSER SPECIFIC CONTEXT:\n${userContext}`
            : basePrompt;

        const combinedText = `${personaPrompt}\n\n---\n\n${context}`;

        await copyToClipboard(combinedText, button, 'Copied! Paste it in your AI Chat', originalText);
    });
</script>
